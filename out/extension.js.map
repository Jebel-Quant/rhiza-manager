{
  "version": 3,
  "sources": ["../src/extension.ts"],
  "sourcesContent": ["import * as vscode from \"vscode\";\nimport { exec } from \"child_process\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\n// --------------------------\n// Helper functions\n// --------------------------\nfunction runGitCommand(repoPath: string, command: string): Promise<string> {\n  return new Promise((resolve, reject) => {\n    exec(command, { cwd: repoPath }, (err, stdout, stderr) => {\n      if (err) {\n        reject(stderr || err.message);\n      } else {\n        resolve(stdout.trim());\n      }\n    });\n  });\n}\n\nasync function getRepoStatus(repoPath: string) {\n  try {\n    const branch = (await runGitCommand(repoPath, \"git branch --show-current\")) || \"detached\";\n    const dirtyOutput = await runGitCommand(repoPath, \"git status --porcelain\");\n    const dirty = dirtyOutput.length > 0;\n    let ahead = 0, behind = 0;\n\n    try {\n      const revList = await runGitCommand(\n        repoPath,\n        \"git rev-list --left-right --count HEAD...@{upstream}\"\n      );\n      [ahead, behind] = revList.split(\"\\t\").map(Number);\n    } catch { /* upstream may not exist */ }\n\n    return { branch, dirty, ahead, behind };\n  } catch {\n    return { branch: \"unknown\", dirty: false, ahead: 0, behind: 0 };\n  }\n}\n\n// --------------------------\n// TreeItem for each repo\n// --------------------------\nclass RepoItem extends vscode.TreeItem {\n  constructor(\n    public readonly repoPath: string,\n    public readonly label: string,\n    public readonly status?: string\n  ) {\n    super(label, vscode.TreeItemCollapsibleState.None);\n    this.tooltip = repoPath;\n    this.description = status;\n    this.contextValue = \"repo\";\n  }\n}\n\n// --------------------------\n// TreeDataProvider\n// --------------------------\nclass RepoProvider implements vscode.TreeDataProvider<RepoItem> {\n  private _onDidChangeTreeData = new vscode.EventEmitter<RepoItem | undefined>();\n  readonly onDidChangeTreeData = this._onDidChangeTreeData.event;\n\n  refresh(): void {\n    this._onDidChangeTreeData.fire(undefined);\n  }\n\n  getTreeItem(item: RepoItem): vscode.TreeItem {\n    return item;\n  }\n\n  async getChildren(): Promise<RepoItem[]> {\n    const folders = vscode.workspace.workspaceFolders;\n    if (!folders) return [];\n\n    const repos: RepoItem[] = [];\n\n    for (const folder of folders) {\n      const root = folder.uri.fsPath;\n      for (const entry of fs.readdirSync(root)) {\n        const fullPath = path.join(root, entry);\n        if (fs.statSync(fullPath).isDirectory() && fs.existsSync(path.join(fullPath, \".git\"))) {\n          const status = await getRepoStatus(fullPath);\n          const desc = `${status.branch} \u00B7 ${status.dirty ? \"dirty\" : \"clean\"} \u00B7 \u2191${status.ahead} \u2193${status.behind}`;\n          repos.push(new RepoItem(fullPath, entry, desc));\n        }\n      }\n    }\n\n    return repos;\n  }\n}\n\n// --------------------------\n// Activate Extension\n// --------------------------\nexport function activate(context: vscode.ExtensionContext) {\n  const provider = new RepoProvider();\n  vscode.window.registerTreeDataProvider(\"repoManagerView\", provider);\n\n  // Refresh command\n  context.subscriptions.push(\n    vscode.commands.registerCommand(\"repoManager.refresh\", () => provider.refresh())\n  );\n\n  // Pull All command\n  context.subscriptions.push(\n    vscode.commands.registerCommand(\"repoManager.pullAll\", async () => {\n      const repos = await provider.getChildren();\n      await vscode.window.withProgress(\n        {\n          location: vscode.ProgressLocation.Notification,\n          title: \"Pulling all repositories\",\n        },\n        async () => {\n          for (const repo of repos) {\n            try {\n              await runGitCommand(repo.repoPath, \"git pull\");\n              vscode.window.showInformationMessage(`\u2705 Pulled ${repo.label}`);\n            } catch (err) {\n              vscode.window.showErrorMessage(`\u274C ${repo.label}: ${err}`);\n            }\n          }\n          provider.refresh();\n        }\n      );\n    })\n  );\n\n  // Fetch All command\n  context.subscriptions.push(\n    vscode.commands.registerCommand(\"repoManager.fetchAll\", async () => {\n      const repos = await provider.getChildren();\n      await vscode.window.withProgress(\n        {\n          location: vscode.ProgressLocation.Notification,\n          title: \"Fetching all repositories\",\n        },\n        async () => {\n          for (const repo of repos) {\n            try {\n              await runGitCommand(repo.repoPath, \"git fetch\");\n              vscode.window.showInformationMessage(`\u2705 Fetched ${repo.label}`);\n            } catch (err) {\n              vscode.window.showErrorMessage(`\u274C ${repo.label}: ${err}`);\n            }\n          }\n          provider.refresh();\n        }\n      );\n    })\n  );\n}\n\n// --------------------------\n// Deactivate Extension\n// --------------------------\nexport function deactivate() {}\n"],
  "mappings": "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",
  "names": []
}
